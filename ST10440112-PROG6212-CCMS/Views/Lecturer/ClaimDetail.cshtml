@model ST10440112_PROG6212_CCMS.Models.Claim

@{
    ViewData["Title"] = "Claim Detail";
}

<div class="container mt-4">
    <div class="row mb-4">
        <div class="col-md-8">
            <h2><i class="bi bi-file-earmark-text"></i> Claim Details</h2>
            <p class="text-muted">View your claim information and status</p>
        </div>
        <div class="col-md-4 text-end">
            <a href="@Url.Action("MyClaims", "Lecturer")" class="btn btn-secondary">
                <i class="bi bi-arrow-left"></i> Back to My Claims
            </a>
        </div>
    </div>

    <div class="row">
        <div class="col-md-8">
            <div class="card shadow-sm mb-4">
                <div class="card-header" style="background-color: #13325B; color: white;">
                    <h5 class="mb-0">Claim Information</h5>
                </div>
                <div class="card-body">
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <h6 class="text-muted">Claim Date</h6>
                            <p><strong>@Model.ClaimDate.ToString("dd MMMM yyyy")</strong></p>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-muted">Submission Date</h6>
                            <p><strong>@Model.SubmissionDate.ToString("dd MMMM yyyy")</strong></p>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <h6 class="text-muted">Total Hours Worked</h6>
                            <p><strong style="font-size: 1.25rem;">@Model.TotalHours.ToString("F1") hours</strong></p>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-muted">Hourly Rate</h6>
                            <p><strong style="font-size: 1.25rem;">R @Model.HourlyRate.ToString("N2")</strong></p>
                        </div>
                    </div>

                    <hr>

                    <div class="row mb-3">
                        <div class="col-md-12">
                            <h6 class="text-muted">Total Amount</h6>
                            <p><strong style="font-size: 1.75rem; color: #13325B;">R @(Model.TotalHours * Model.HourlyRate).ToString("N2")</strong></p>
                        </div>
                    </div>

                    <hr>

                    <div class="row">
                        <div class="col-md-6">
                            <h6 class="text-muted">Status</h6>
                            @{
                                var badgeClass = Model.ClaimStatus switch
                                {
                                    "Pending" => "bg-warning",
                                    "Approved" => "bg-success",
                                    "Rejected" => "bg-danger",
                                    _ => "bg-secondary"
                                };
                            }
                            <p><span class="badge @badgeClass" style="font-size: 0.95rem;">@Model.ClaimStatus</span></p>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-muted">Approved Date</h6>
                            <p>
                                @if (Model.ApprovedDate.HasValue)
                                {
                                    <strong>@Model.ApprovedDate.Value.ToString("dd MMMM yyyy")</strong>
                                }
                                else
                                {
                                    <span class="text-muted">-</span>
                                }
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            @if (Model.Documents.Count > 0)
            {
                <div class="card shadow-sm mb-4">
                    <div class="card-header" style="background-color: #13325B; color: white;">
                        <h5 class="mb-0">Attached Documents</h5>
                    </div>
                    <div class="card-body">
                        <div class="list-group">
                            @foreach (var doc in Model.Documents)
                            {
                                <a href="@doc.DocumentPath" class="list-group-item list-group-item-action">
                                    <div class="d-flex w-100 justify-content-between">
                                        <h6 class="mb-1"><i class="bi bi-file"></i> @doc.DocumentName</h6>
                                        <small>@doc.UploadDate.ToString("dd MMM yyyy")</small>
                                    </div>
                                </a>
                            }
                        </div>
                    </div>
                </div>
            }

            @if (Model.Comments.Count > 0)
            {
                <div class="card shadow-sm">
                    <div class="card-header" style="background-color: #13325B; color: white;">
                        <h5 class="mb-0">Comments</h5>
                    </div>
                    <div class="card-body">
                        @foreach (var comment in Model.Comments.OrderByDescending(c => c.CommentDate))
                        {
                            <div class="card mb-2">
                                <div class="card-header" style="background-color: #f8f9fa;">
                                    <small class="text-muted">@comment.CommentDate.ToString("dd MMM yyyy HH:mm")</small>
                                </div>
                                <div class="card-body">
                                    <p class="mb-0">@comment.CommentText</p>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            }
        </div>

        <div class="col-md-4">
            <div class="card shadow-sm">
                <div class="card-header" style="background-color: #9F7944; color: white;">
                    <h6 class="mb-0"><i class="bi bi-info-circle"></i> Claim Summary</h6>
                </div>
                <div class="card-body">
                    <ul class="list-unstyled">
                        <li class="mb-2">
                            <strong>Claim ID:</strong><br>
                            <small class="text-muted">@Model.ClaimId</small>
                        </li>
                        <li class="mb-2">
                            <strong>Current Status:</strong><br>
                            <span class="badge @(Model.ClaimStatus switch
                            {
                                "Pending" => "bg-warning",
                                "Approved" => "bg-success",
                                "Rejected" => "bg-danger",
                                _ => "bg-secondary"
                            })">@Model.ClaimStatus</span>
                        </li>
                        <li class="mb-2">
                            <strong>Total Amount:</strong><br>
                            <span style="font-size: 1.1rem; color: #13325B; font-weight: 600;">R @(Model.TotalHours * Model.HourlyRate).ToString("N2")</span>
                        </li>
                        <li>
                            <strong>Payment Status:</strong><br>
                            @if (Model.IsSettled)
                            {
                                <span class="badge bg-success">Paid</span>
                            }
                            else if (Model.ClaimStatus == "Approved")
                            {
                                <span class="badge bg-info">Pending Payment</span>
                            }
                            else
                            {
                                <span class="badge bg-secondary">Not Applicable</span>
                            }
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
